import 'package:flutter/material.dart';
import 'package:adobe_xd/pinned.dart';
import "./XDmonitorpage.dart";
import "./XDhistorypageday.dart";
import "./XDadministratorpage1.dart";
import 'package:flutter_svg/flutter_svg.dart';

///这个页面是作为整个APP的最外层的容器，以Tab为基础控制每个item的显示与隐藏
class ContainerPage extends StatefulWidget {
  ContainerPage({Key? key}) : super(key: key);

  @override
  State<StatefulWidget> createState() {
    return _ContainerPageState();
  }
}

class _ContainerPageState extends State<ContainerPage> {
  late List<Widget> pages;

  @override
  void initState() {
    super.initState();
    print('initState _ContainerPageState');
    pages = [
      XDmonitorpage(),
      XDhistorypageday(),
      XDadministratorpage1()
    ];
  }
  int _selectIndex = 0;

//Stack（层叠布局）+Offstage组合,解决状态被重置的问题
  Widget _getPagesWidget(int index) {
    return Offstage(
      offstage: _selectIndex != index,
      child: TickerMode(
        enabled: _selectIndex == index,
        child: pages[index],
      ),
    );
  }


  @override
  void didUpdateWidget(ContainerPage oldWidget) {
    super.didUpdateWidget(oldWidget);
    print('didUpdateWidget');
  }

  @override
  Widget build(BuildContext context) {
//    Scaffold({
//    Key key,
//    this.appBar,
//    this.body,
//    this.floatingActionButton,
//    this.floatingActionButtonLocation,
//    this.floatingActionButtonAnimator,
//    this.persistentFooterButtons,
//    this.drawer,
//    this.endDrawer,
//    this.bottomNavigationBar,
//    this.bottomSheet,
//    this.backgroundColor,
//    this.resizeToAvoidBottomPadding = true,
//    this.primary = true,
//    })
    
    Widget navigator = Stack(
      // Adobe XD layer: '底部导航栏' (group)
      children: <Widget>[
        Pinned.fromPins(
          Pin(start: 0.0, end: 0.0),
          Pin(size: 80.0, end: 0.0),
          child: Container(
            // Adobe XD layer: '底部背景' (shape)
            decoration: BoxDecoration(
              color: const Color(0xffffffff),
              border: Border.all(
                  width: 1.0, color: const Color(0xffdee1ea)),
            ),
          ),
        ),
        Pinned.fromPins(
          Pin(size: 120.0, start: 14.0),
          Pin(size: 80.0, end: 0.0),
          child: TextButton(
            // Adobe XD layer: '实时按钮' (group)
            onPressed: () {
              setState(() {
                _selectIndex = 0;
              });
            },
            child: Stack(
              children: <Widget>[
                Pinned.fromPins(
                  Pin(start: 0.0, end: 0.0),
                  Pin(start: 0.0, end: 0.0),
                  child: Container(
                    decoration: BoxDecoration(
                      color: const Color(0x00ffffff),
                    ),
                  ),
                ),
                Pinned.fromPins(
                  Pin(size: 72.0, middle: 0.5),
                  Pin(start: 8.0, end: 6.0),
                  child: Stack(
                    children: <Widget>[
                      Pinned.fromPins(
                        Pin(size: 26.0, middle: 0.5),
                        Pin(size: 26.0, start: 0.0),
                        child:
                          // Adobe XD layer: 'ic_library_books_24…' (shape)
                          SvgPicture.string(
                          _selectIndex == 0 ? _svg_d5wlhm : _svg_kvro9q,
                          allowDrawingOutsideViewBox: true,
                          fit: BoxFit.fill,
                        ),
                      ),
                      Pinned.fromPins(
                        Pin(start: 0.0, end: 0.0),
                        Pin(size: 17.0, end: 0.0),
                        child: Text(
                          '实时监测',
                          style: TextStyle(
                            fontFamily: 'Microsoft YaHei',
                            fontSize: 13,
                            color: const Color(0xff8d8d8d),
                          ),
                          textAlign: TextAlign.center,
                        ),
                      ),
                    ],
                  ),
                ),
              ],
            ),
          ),
        ),
        Pinned.fromPins(
          Pin(size: 120.0, middle: 0.5),
          Pin(size: 80.0, end: 0.0),
          child: TextButton(
            // Adobe XD layer: '历史按钮' (group)
            onPressed: () {
              setState(() {
                _selectIndex = 1;
              });
            },
            child: Stack(
              children: <Widget>[
                Pinned.fromPins(
                  Pin(start: 0.0, end: 0.0),
                  Pin(start: 0.0, end: 0.0),
                  child: Container(
                    decoration: BoxDecoration(
                      color: const Color(0x00f5f5f5),
                    ),
                  ),
                ),
                Pinned.fromPins(
                  Pin(size: 72.0, middle: 0.5),
                  Pin(size: 40.0, end: 6.0),
                  child: Stack(
                    children: <Widget>[
                      Pinned.fromPins(
                        Pin(start: 23.0, end: 23.0),
                        Pin(size: 14.2, start: 0.0),
                        child: SvgPicture.string(
                          // Adobe XD layer: 'ic_timeline_24px' (shape)
                          _selectIndex == 1 ? _svg_o2svtf : _svg_gcxt1b,
                          allowDrawingOutsideViewBox: true,
                          fit: BoxFit.fill,
                        ),
                      ),
                      Pinned.fromPins(
                        Pin(start: 0.0, end: 0.0),
                        Pin(size: 17.0, end: 0.0),
                        child: Text(
                          '历史数据',
                          style: TextStyle(
                            fontFamily: 'Microsoft YaHei',
                            fontSize: 13,
                            color: const Color(0xff8d8d8d),
                          ),
                          textAlign: TextAlign.center,
                        ),
                      ),
                    ],
                  ),
                ),
              ],
            ),
          ),
        ),
        Pinned.fromPins(
          Pin(size: 120.0, end: 14.0),
          Pin(size: 80.0, end: 0.0),
          child: TextButton(
            // Adobe XD layer: '历史按钮' (group)
            onPressed: () {
              setState(() {
                _selectIndex = 2;
              });
            },
            child: Stack(
              children: <Widget>[
                Pinned.fromPins(
                  Pin(start: 0.0, end: 0.0),
                  Pin(start: 0.0, end: 0.0),
                  child: Container(
                    decoration: BoxDecoration(
                      color: const Color(0x00ffffff),
                    ),
                  ),
                ),
                Pinned.fromPins(
                  Pin(size: 72.0, middle: 0.5),
                  Pin(start: 8.0, end: 6.0),
                  child: Stack(
                    children: <Widget>[
                      Pinned.fromPins(
                        Pin(size: 19.8, middle: 0.5),
                        Pin(size: 26.0, start: 0.0),
                        child: SvgPicture.string(
                          // Adobe XD layer: 'ic_lock_outline_24px' (shape)
                          _selectIndex == 2 ? _svg_220zok : _svg_9rw2go,
                          allowDrawingOutsideViewBox: true,
                          fit: BoxFit.fill,
                        ),
                      ),
                      Pinned.fromPins(
                        Pin(start: 0.0, end: 0.0),
                        Pin(size: 17.0, end: 0.0),
                        child: Text(
                          '药房管理',
                          style: TextStyle(
                            fontFamily: 'Microsoft YaHei',
                            fontSize: 13,
                            color: const Color(0xff8d8d8d),
                          ),
                          textAlign: TextAlign.center,
                        ),
                      ),
                    ],
                  ),
                ),
              ],
            ),
          ),
        ),
        Pinned.fromPins(
          _selectIndex == 0 ? Pin(size: 88.0, start: 32.0) : _selectIndex == 1 ? Pin(size: 88.0, middle: 0.5) : Pin(size: 88.0, end: 30.0),
          Pin(size: 4.0, end: 76.0),
          child: Container(
            // Adobe XD layer: '横线导航' (shape)
            decoration: BoxDecoration(
              borderRadius: BorderRadius.circular(26.0),
              color: const Color(0xff7ea6d9),
              boxShadow: [
                BoxShadow(
                  color: const Color(0x29000000),
                  offset: Offset(3, 3),
                  blurRadius: 6,
                ),
              ],
            ),
          ),
        ),
      ],
    );

    print('build _ContainerPageState');
    return Scaffold(
      body: new Stack(
        children: [
          _getPagesWidget(0),
          _getPagesWidget(1),
          _getPagesWidget(2),
          navigator,
        ],
      ),
//        List<BottomNavigationBarItem>
//        @required this.icon,
//    this.title,
//    Widget activeIcon,
//    this.backgroundColor,
      backgroundColor: Color.fromARGB(255, 255, 255, 255)
    );
  }
}
const String _svg_d5wlhm =
    '<svg viewBox="13.0 3.6 26.0 26.0" ><path transform="translate(11.0, 1.57)" d="M 4.600000381469727 7.20000171661377 L 2 7.20000171661377 L 2 25.39999961853027 C 2 26.83000183105469 3.170000314712524 28 4.600000381469727 28 L 22.80000114440918 28 L 22.80000114440918 25.39999961853027 L 4.600000381469727 25.39999961853027 L 4.600000381469727 7.20000171661377 Z M 25.39999961853027 2 L 9.800002098083496 2 C 8.369999885559082 2 7.20000171661377 3.170000314712524 7.20000171661377 4.600000381469727 L 7.20000171661377 20.20000076293945 C 7.20000171661377 21.6299991607666 8.369999885559082 22.80000114440918 9.800002098083496 22.80000114440918 L 25.39999961853027 22.80000114440918 C 26.83000183105469 22.80000114440918 28 21.6299991607666 28 20.20000076293945 L 28 4.600000381469727 C 28 3.170000314712524 26.83000183105469 2 25.39999961853027 2 Z M 24.10000038146973 13.69999980926514 L 11.10000228881836 13.69999980926514 L 11.10000228881836 11.10000228881836 L 24.10000038146973 11.10000228881836 L 24.10000038146973 13.69999980926514 Z M 18.89999961853027 18.89999961853027 L 11.10000228881836 18.89999961853027 L 11.10000228881836 16.30000114440918 L 18.89999961853027 16.30000114440918 L 18.89999961853027 18.89999961853027 Z M 24.10000038146973 8.500000953674316 L 11.10000228881836 8.500000953674316 L 11.10000228881836 5.900001525878906 L 24.10000038146973 5.900001525878906 L 24.10000038146973 8.500000953674316 Z" fill="#7ea6d9" stroke="none" stroke-width="1" stroke-miterlimit="4" stroke-linecap="butt" /></svg>';
const String _svg_gcxt1b =
    '<svg viewBox="13.0 3.5 26.0 14.2" ><path transform="translate(12.0, -2.49)" d="M 26.99999809265137 8.36363410949707 C 26.99999809265137 9.663634300231934 25.93635940551758 10.72727108001709 24.63636016845703 10.72727108001709 C 24.42363166809082 10.72727108001709 24.22272300720215 10.70363426208496 24.03363227844238 10.64454364776611 L 19.82636070251465 14.83999729156494 C 19.88545036315918 15.02908802032471 19.90908813476562 15.24181747436523 19.90908813476562 15.45454120635986 C 19.90908813476562 16.75454330444336 18.84545135498047 17.81818008422852 17.54545021057129 17.81818008422852 C 16.24545097351074 17.81818008422852 15.1818151473999 16.75454330444336 15.1818151473999 15.45454120635986 C 15.1818151473999 15.2418155670166 15.20545101165771 15.02908802032471 15.26454257965088 14.83999729156494 L 12.2509069442749 11.82636070251465 C 12.06181621551514 11.88545227050781 11.84908866882324 11.90908813476562 11.63636207580566 11.90908813476562 C 11.42363548278809 11.90908813476562 11.21090793609619 11.8854513168335 11.02181625366211 11.82636070251465 L 5.644544124603271 17.21545219421387 C 5.703635215759277 17.40454292297363 5.727271556854248 17.6054515838623 5.727271556854248 17.81818008422852 C 5.727271556854248 19.11817932128906 4.663634777069092 20.18181610107422 3.363635778427124 20.18181610107422 C 2.063635587692261 20.18181610107422 0.9999995231628418 19.11817932128906 0.9999995231628418 17.81818008422852 C 0.9999995231628418 16.5181770324707 2.063635349273682 15.45454120635986 3.363635778427124 15.45454120635986 C 3.57636284828186 15.45454120635986 3.777271747589111 15.47818088531494 3.966362714767456 15.53726959228516 L 9.355453491210938 10.15999794006348 C 9.29636287689209 9.970907211303711 9.272726058959961 9.758179664611816 9.272726058959961 9.545453071594238 C 9.272726058959961 8.245452880859375 10.3363618850708 7.181817531585693 11.63636207580566 7.181817531585693 C 12.93636322021484 7.181817531585693 13.99999713897705 8.245452880859375 13.99999713897705 9.545453071594238 C 13.99999713897705 9.758179664611816 13.97636127471924 9.970907211303711 13.91726970672607 10.15999889373779 L 16.93090438842773 13.17363548278809 C 17.1199951171875 13.11454391479492 17.33272552490234 13.09090900421143 17.54545021057129 13.09090900421143 C 17.75817680358887 13.09090900421143 17.97090339660645 13.11454486846924 18.15999603271484 13.17363548278809 L 22.35544967651367 8.966361999511719 C 22.29636001586914 8.777271270751953 22.27272415161133 8.576361656188965 22.27272415161133 8.36363410949707 C 22.27272415161133 7.063636302947998 23.33635902404785 6 24.63636016845703 6 C 25.93635940551758 6 26.99999809265137 7.063636302947998 26.99999809265137 8.36363410949707 Z" fill="#8d8d8d" stroke="none" stroke-width="1" stroke-miterlimit="4" stroke-linecap="butt" /></svg>';
const String _svg_9rw2go =
    '<svg viewBox="16.1 3.6 19.8 26.0" ><path transform="translate(12.1, 2.57)" d="M 13.90476036071777 20.80952262878418 C 15.2666654586792 20.80952262878418 16.38095092773438 19.69523811340332 16.38095092773438 18.33333396911621 C 16.38095092773438 16.97142791748047 15.2666654586792 15.85714244842529 13.90476036071777 15.85714244842529 C 12.54285526275635 15.85714244842529 11.42856979370117 16.97142791748047 11.42856979370117 18.33333396911621 C 11.42856979370117 19.69523811340332 12.54285526275635 20.80952262878418 13.90476036071777 20.80952262878418 Z M 21.33333206176758 9.666666984558105 L 20.09523773193359 9.666666984558105 L 20.09523773193359 7.190476417541504 C 20.09523773193359 3.773333311080933 17.3219051361084 1 13.90476036071777 1 C 10.48761749267578 1 7.714285373687744 3.773333311080933 7.714285373687744 7.190476417541504 L 7.714285373687744 9.666666984558105 L 6.476190090179443 9.666666984558105 C 5.114286422729492 9.666666984558105 4 10.78095245361328 4 12.14285659790039 L 4 24.5238094329834 C 4 25.88571357727051 5.114286422729492 26.99999809265137 6.476190090179443 26.99999809265137 L 21.33333206176758 26.99999809265137 C 22.69523811340332 26.99999809265137 23.80952262878418 25.88571357727051 23.80952262878418 24.5238094329834 L 23.80952262878418 12.14285659790039 C 23.80952262878418 10.78095245361328 22.69523811340332 9.666666984558105 21.33333206176758 9.666666984558105 Z M 10.06666564941406 7.190476417541504 C 10.06666564941406 5.073333263397217 11.78761863708496 3.352380990982056 13.90476036071777 3.352380990982056 C 16.02190399169922 3.352380990982056 17.74285697937012 5.073333263397217 17.74285697937012 7.190476417541504 L 17.74285697937012 9.666666984558105 L 10.06666564941406 9.666666984558105 L 10.06666564941406 7.190476417541504 Z M 21.33333206176758 24.5238094329834 L 6.476190090179443 24.5238094329834 L 6.476190090179443 12.14285659790039 L 21.33333206176758 12.14285659790039 L 21.33333206176758 24.5238094329834 Z" fill="#8d8d8d" stroke="none" stroke-width="1" stroke-miterlimit="4" stroke-linecap="butt" /></svg>';
const String _svg_kvro9q =
    '<svg viewBox="13.0 3.6 26.0 26.0" ><path transform="translate(11.0, 1.57)" d="M 4.600000381469727 7.20000171661377 L 2 7.20000171661377 L 2 25.39999961853027 C 2 26.83000183105469 3.170000314712524 28 4.600000381469727 28 L 22.80000114440918 28 L 22.80000114440918 25.39999961853027 L 4.600000381469727 25.39999961853027 L 4.600000381469727 7.20000171661377 Z M 25.39999961853027 2 L 9.800002098083496 2 C 8.369999885559082 2 7.20000171661377 3.170000314712524 7.20000171661377 4.600000381469727 L 7.20000171661377 20.20000076293945 C 7.20000171661377 21.6299991607666 8.369999885559082 22.80000114440918 9.800002098083496 22.80000114440918 L 25.39999961853027 22.80000114440918 C 26.83000183105469 22.80000114440918 28 21.6299991607666 28 20.20000076293945 L 28 4.600000381469727 C 28 3.170000314712524 26.83000183105469 2 25.39999961853027 2 Z M 24.10000038146973 13.69999980926514 L 11.10000228881836 13.69999980926514 L 11.10000228881836 11.10000228881836 L 24.10000038146973 11.10000228881836 L 24.10000038146973 13.69999980926514 Z M 18.89999961853027 18.89999961853027 L 11.10000228881836 18.89999961853027 L 11.10000228881836 16.30000114440918 L 18.89999961853027 16.30000114440918 L 18.89999961853027 18.89999961853027 Z M 24.10000038146973 8.500000953674316 L 11.10000228881836 8.500000953674316 L 11.10000228881836 5.900001525878906 L 24.10000038146973 5.900001525878906 L 24.10000038146973 8.500000953674316 Z" fill="#8d8d8d" stroke="none" stroke-width="1" stroke-miterlimit="4" stroke-linecap="butt" /></svg>';
const String _svg_o2svtf =
    '<svg viewBox="13.0 3.5 26.0 14.2" ><path transform="translate(12.0, -2.49)" d="M 26.99999809265137 8.36363410949707 C 26.99999809265137 9.663634300231934 25.93635940551758 10.72727108001709 24.63636016845703 10.72727108001709 C 24.42363166809082 10.72727108001709 24.22272300720215 10.70363426208496 24.03363227844238 10.64454364776611 L 19.82636070251465 14.83999729156494 C 19.88545036315918 15.02908802032471 19.90908813476562 15.24181747436523 19.90908813476562 15.45454120635986 C 19.90908813476562 16.75454330444336 18.84545135498047 17.81818008422852 17.54545021057129 17.81818008422852 C 16.24545097351074 17.81818008422852 15.1818151473999 16.75454330444336 15.1818151473999 15.45454120635986 C 15.1818151473999 15.2418155670166 15.20545101165771 15.02908802032471 15.26454257965088 14.83999729156494 L 12.2509069442749 11.82636070251465 C 12.06181621551514 11.88545227050781 11.84908866882324 11.90908813476562 11.63636207580566 11.90908813476562 C 11.42363548278809 11.90908813476562 11.21090793609619 11.8854513168335 11.02181625366211 11.82636070251465 L 5.644544124603271 17.21545219421387 C 5.703635215759277 17.40454292297363 5.727271556854248 17.6054515838623 5.727271556854248 17.81818008422852 C 5.727271556854248 19.11817932128906 4.663634777069092 20.18181610107422 3.363635778427124 20.18181610107422 C 2.063635587692261 20.18181610107422 0.9999995231628418 19.11817932128906 0.9999995231628418 17.81818008422852 C 0.9999995231628418 16.5181770324707 2.063635349273682 15.45454120635986 3.363635778427124 15.45454120635986 C 3.57636284828186 15.45454120635986 3.777271747589111 15.47818088531494 3.966362714767456 15.53726959228516 L 9.355453491210938 10.15999794006348 C 9.29636287689209 9.970907211303711 9.272726058959961 9.758179664611816 9.272726058959961 9.545453071594238 C 9.272726058959961 8.245452880859375 10.3363618850708 7.181817531585693 11.63636207580566 7.181817531585693 C 12.93636322021484 7.181817531585693 13.99999713897705 8.245452880859375 13.99999713897705 9.545453071594238 C 13.99999713897705 9.758179664611816 13.97636127471924 9.970907211303711 13.91726970672607 10.15999889373779 L 16.93090438842773 13.17363548278809 C 17.1199951171875 13.11454391479492 17.33272552490234 13.09090900421143 17.54545021057129 13.09090900421143 C 17.75817680358887 13.09090900421143 17.97090339660645 13.11454486846924 18.15999603271484 13.17363548278809 L 22.35544967651367 8.966361999511719 C 22.29636001586914 8.777271270751953 22.27272415161133 8.576361656188965 22.27272415161133 8.36363410949707 C 22.27272415161133 7.063636302947998 23.33635902404785 6 24.63636016845703 6 C 25.93635940551758 6 26.99999809265137 7.063636302947998 26.99999809265137 8.36363410949707 Z" fill="#7ea6d9" stroke="none" stroke-width="1" stroke-miterlimit="4" stroke-linecap="butt" /></svg>';
const String _svg_220zok =
    '<svg viewBox="16.1 3.6 19.8 26.0" ><path transform="translate(12.1, 2.57)" d="M 13.90476036071777 20.80952262878418 C 15.2666654586792 20.80952262878418 16.38095092773438 19.69523811340332 16.38095092773438 18.33333396911621 C 16.38095092773438 16.97142791748047 15.2666654586792 15.85714244842529 13.90476036071777 15.85714244842529 C 12.54285526275635 15.85714244842529 11.42856979370117 16.97142791748047 11.42856979370117 18.33333396911621 C 11.42856979370117 19.69523811340332 12.54285526275635 20.80952262878418 13.90476036071777 20.80952262878418 Z M 21.33333206176758 9.666666984558105 L 20.09523773193359 9.666666984558105 L 20.09523773193359 7.190476417541504 C 20.09523773193359 3.773333311080933 17.3219051361084 1 13.90476036071777 1 C 10.48761749267578 1 7.714285373687744 3.773333311080933 7.714285373687744 7.190476417541504 L 7.714285373687744 9.666666984558105 L 6.476190090179443 9.666666984558105 C 5.114286422729492 9.666666984558105 4 10.78095245361328 4 12.14285659790039 L 4 24.5238094329834 C 4 25.88571357727051 5.114286422729492 26.99999809265137 6.476190090179443 26.99999809265137 L 21.33333206176758 26.99999809265137 C 22.69523811340332 26.99999809265137 23.80952262878418 25.88571357727051 23.80952262878418 24.5238094329834 L 23.80952262878418 12.14285659790039 C 23.80952262878418 10.78095245361328 22.69523811340332 9.666666984558105 21.33333206176758 9.666666984558105 Z M 10.06666564941406 7.190476417541504 C 10.06666564941406 5.073333263397217 11.78761863708496 3.352380990982056 13.90476036071777 3.352380990982056 C 16.02190399169922 3.352380990982056 17.74285697937012 5.073333263397217 17.74285697937012 7.190476417541504 L 17.74285697937012 9.666666984558105 L 10.06666564941406 9.666666984558105 L 10.06666564941406 7.190476417541504 Z M 21.33333206176758 24.5238094329834 L 6.476190090179443 24.5238094329834 L 6.476190090179443 12.14285659790039 L 21.33333206176758 12.14285659790039 L 21.33333206176758 24.5238094329834 Z" fill="#7ea6d9" stroke="none" stroke-width="1" stroke-miterlimit="4" stroke-linecap="butt" /></svg>';
